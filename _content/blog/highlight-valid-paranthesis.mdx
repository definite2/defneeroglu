---
title: 'Calculate Number of Characters Fit into an HTML Element'
date: '2022-07-25'
lastmod: '2022-07-25'
tags: ['problem-solving', 'react']
draft: true
summary: 'Learn how you can highilight valid parentheses in a sentence.'
isToc: true
image: ['/content/dynamicaly_fit.svg']
alt: 'dynamically truncate text cover'
tocPaddingTop: '2.5rem'
---

In this blog, I am going to share Leetcode(ish) solution for highilighting valid parantheses in a text which contains not only parentheses, but also other characters. Solution is going to be used in a React component so you can easily use this in your projects.

## Introduction

As leetcode is very useful in the process of preparing for interviews, practicing here will also help those who are already has a job, to improve their problem-solving skills or their ability to look at problems from a different perspective.
One of the popular questions from Leetcode is [Valid Parantheses](https://leetcode.com/problems/valid-parentheses/) problem. It asks you to find whether a given string is valid in terms of it has all opening and closing pairs of parenthesis. In the question the given string includes only parantheses not any other letter and there are three different type of parenthesis: `()`, `{}` and `[]`.
Example which is valid or not:

```
(((((()))))) -- VALID

()()()()     -- VALID

(((((((()    -- INVALID

((()(())))   -- VALID
```

I suggest you to before reading this blog, go to the question link above, and try to solve it. The problem we are going to deal with is very similar problem however we are going to use the solution in a React component and we are going to add a little bit of CSS.

### The Problem: Highlight Valid Parantheses

###

<figure className="flex justify-center flex-col items-center bg-transparent">
  <Image alt="truncate from middle" src="/content/text_long.png" width="425" height="48" priority />
  <figcaption className="text-sm italic">
    Truncating 'text text text' in different container widths
  </figcaption>
</figure>

The challenge is that the width of the buttons were not fixed, and the text inside of them were not fixed as well. In short, I had to do the following:

- calculating the width of the button,
- then calculating the width of the button's text,
- then compare that if the width of the text is larger than the width of the button, then cut the text in the middle with three dots...
  But also I needed to find how to cut, I mean how many characters should be shown? Let's solve this together.

## Final Code and Demo

You can find the full code and a demo for the subject of this blog, dynamically calculating fit character length, from this [repository](https://github.com/definite2/truncate-middle)

### Width of Button

Since the width of the button is dynamic, and itself loads asynchronously; we cannot calculate width by using the `componentDidMount` or `useEffect` hook. Instead we need to use the `useLayoutEffect` hook due to the asynchronous UI effect.<br/>
And to follow the size changes of an element, I used [`ResizeObserver`](https://developer.mozilla.org/en-US/docs/Web/API/ResizeObserver#examples) which is a Web API Interface that is available in most browsers.<br/>
There is another way to watch size changes of an element that is `addEventListener('resize',()=>{})` approach. However, I suggest using ResizeObserver instead, because it is more reliable since it is easier to disconnect the observer and to stop the listening callbacks. Actually, I suggest you do your own research about when to use ResizeObserver over Resize Event Listener, you can start from reading comments in this [issue](https://github.com/w3ctag/design-principles/issues/78).

```js
/* eslint-disable no-plusplus */
/**
 * highlights valid parathesis
 */
import React from 'react'
import './style.scss'

const HighlightBrackets = ({ text }) => {
  const pairs = { '{': '}' }
  const stack = []
  const pairKeyIndexStack = []
  // eslint-disable-next-line no-unused-vars
  const highlightsIndexes = Array.from({ length: text.length }).map((i) => false)
  for (let i = 0; i < text.length; i++) {
    if (pairs[text[i]]) {
      stack.push(pairs[stack[i]])
      pairKeyIndexStack.push(i)
    } else if (text[i] === '}' && stack.length !== 0) {
      stack.pop()
      highlightsIndexes[pairKeyIndexStack.pop()] = true
      highlightsIndexes[i] = true
    }
  }

  return (
    <>
      {[...text].map((str, i) => (
        <>{highlightsIndexes[i] ? <i className="bracket">{str}</i> : <>{str}</>}</>
      ))}
    </>
  )
}
export default HighlightBrackets
```

```scss
i.bracket {
  font-style: normal;
  color: #00e0e4;
}
i.atSign {
  font-style: normal;
  color: #00e0e4;
}
```

As you see above at the lines 39 and 46, we get one character from start and calculate the text width, and get one character from back then again calculate the text width as comparing the current text width with contianer's content width.

Why we didn't just pick one character from the start, and continue with the loop? Because the purpose here is truncating the text from middle, and since some of characters occupies different width, we needed to pick character from end as well to get more accurate number of characters that fit into button element.

So the solution can be even number and odd number, if it is odd number, we have one extra character from the beginning.
For example suppose our long text is: _'longer button text'_, and button width is _128px_, solution could be :_'long...text'_ or it could be _'longe...text'_.

## Conclusion

In this blog, I would like to share how you can solve truncating text from middle design problem as calculating the maximum number of characters that can fit into a given container element's content width.
We created custom react hook to make our solution reusable across the application. I hope this hook could help you in your work and inspire you to develop your custom hook development skill, as well as your problem solving skillðŸ˜ƒ... Thank you for reading.
